!function(){function Ribs(){this.Model=new _RibsModel,this.Collection=new _RibsCollection,this.View=new _RibsView,this.Router=new _Router}function _RibsView(){this._type="Ribs.View",this.self,this.json,this.el,this.events,this.renderFunc,this.template,this.initialize=function(){},this.defaults={},this.watch}function _RibsModel(){this._type="Ribs.Model",this.self,this.json,this.fetchUrl,this.fetchMethod="get",this.updateUrl,this.updateMethod="post",this.deleteUrl,this.deleteMethod="post",this.createUrl,this.createMethod="post",this.initialize=function(){},this.defaults={},this.watch}function _RibsCollection(){this._type="Ribs.Collection",this.self,this.json,this.model,this.models=[],this.fetchUrl,this.fetchMethod="get",this.updateUrl,this.updateMethod="post",this.deleteUrl,this.deleteMethod="post",this.createUrl,this.createMethod="post",this.defaults={},this.initialize=function(){},this.watch}function _Router(){}this.String.prototype.format=function(){"use strict";if(0===arguments.length)return null;for(var a=this,b=0;b!==arguments.length;++b){var c=new RegExp("\\{"+(b+1)+"\\}","gm");a=a.replace(c,arguments[b])}return a},Ribs.prototype.extend=function(){"use strict";for(var a=function(a,b){for(var c in b)hasOwnProperty.call(b,c)&&(a[c]=b[c]);return a},b={},c=0;c<arguments.length;c++)b=a(b,arguments[c]);return b},Ribs.prototype.make=function(a,b){var c;return 1===arguments.length?c=$.extend(!0,{},a):2===arguments.length?(c=$.extend(!0,{},a),c.set(b)):c=!1,c!==!1&&c.initialize(),c},Ribs.prototype.transferSettings=function(a){var b;return alert("Type: "+a._type),b="Ribs.View"===a._type?Ribs.View.make(a.json):"Ribs.Model"===a._type?Ribs.Model.make(a.json):"Ribs.Collection"===a._type?Ribs.Collection.make(a.json):!1},_RibsView.prototype.make=function(a){var b=Object.create(this);return b=b.adopt(a,b),this.self=b,b},_RibsView.prototype.adopt=function(params,object){var obj;return 1===arguments.length?obj=this:2===arguments.length&&(obj=object,obj.json=params),$.each(params,function(item){var val=params[item];if("el"===item)obj.el=val;else if("events"===item)obj.events=val;else if("render"===item)obj.renderFunc=val;else if("template"===item)obj.template=val;else if("initialize"===item)obj.initialize=val;else if("defaults"===item)obj.defaults="function"==typeof val?val():val;else if("watch"===item)obj.watch=val;else{var code="_RibsView.prototype."+item+" = "+val;eval(code)}}),obj},_RibsView.prototype._doChangeEvent=function(){},_RibsView.prototype.changeEvent=function(a){this.watch[a]&&(_RibsView.prototype._doChangeEvent=this.json[this.watch[a]],_RibsView.prototype._doChangeEvent.call(this))},_RibsView.prototype.get=function(a){return this.defaults[a]},_RibsView.prototype.set=function(a){var b=this;return $.each(a,function(c){b.defaults[c]=a[c],b.watch&&b.changeEvent(c)}),this.defaults},_RibsView.prototype.render=function(){this.renderFunc(),console.log("EVENT");for(event in this.events){var a=this.events[event];$(event).on(a.on,{self:this},this.json[a.fire])}},_RibsModel.prototype.make=function(a){var b=Object.create(this);return b=b.adopt(a,b),this.self=b,b},_RibsModel.prototype.adopt=function(params,object){var obj;return 1===arguments.length?obj=this:2===arguments.length&&(obj=object,obj.json=params),$.each(params,function(item){var val=params[item];if("fetch"===item)obj.fetchUrl=val.url,obj.fetchMethod=val.method?val.method:"get";else if("update"===item)obj.updateUrl=val.url,obj.updateMethod=val.method?val.method:"post";else if("create"===item)obj.createUrl=val.url,obj.createMethod=val.method?val.method:"put";else if("destory"===item)obj.deleteUrl=val.url,obj.deleteMethod=val.method?val.method:"delete";else if("initialize"===item)obj.initialize=val;else if("defaults"===item)obj.defaults="function"==typeof val?val():val;else if("watch"===item)obj.watch=val;else{var code="_RibsModel.prototype."+item+" = "+val;eval(code)}}),obj},_RibsModel.prototype._doChangeEvent=function(){},_RibsModel.prototype.get=function(a){return this.defaults[a]},_RibsModel.prototype.set=function(a){var b=this;return $.each(a,function(c){b.defaults[c]=a[c],b.watch&&b.changeEvent(c)}),this.defaults},_RibsModel.prototype.changeEvent=function(a){this.watch[a]&&(_RibsModel.prototype._doChangeEvent=this.json[this.watch[a]],_RibsModel.prototype._doChangeEvent.call(this))},_RibsModel.prototype.fetch=function(a){this.ajax(this.fetchUrl,this.fetchMethod,a)},_RibsModel.prototype.update=function(a){this.ajax(this.updateUrl,this.updateMethod,a)},_RibsModel.prototype.destory=function(a){this.ajax(this.deleteUrl,this.deleteMethod,a)},_RibsModel.prototype.create=function(a){this.ajax(this.createUrl,this.createMethod,a)},_RibsModel.prototype.ajax=function(a,b,c){var d=c.data?c.data:{},e=c.async?c.async:!0,f=c.done?c.done:function(){},g=c.fail?c.fail:function(){},h=c.always?c.always:function(){};f=f.bind(this),g=g.bind(this),h=h.bind(this);var i=this;$.ajax({url:a,type:b,context:i,data:d,async:e}).done(f).fail(g).always(h)},_RibsCollection.prototype.make=function(a){var b=Object.create(this);return b=b.adopt(a,b),this.self=b,b},_RibsCollection.prototype.adopt=function(params,object){var obj;return 1===arguments.length?obj=this:2===arguments.length&&(obj=object,obj.json=params),$.each(params,function(item){var val=params[item];if("model"===item)obj.model=val;else if("fetch"===item)obj.fetchUrl=val.url,obj.fetchMethod=val.method?val.method:"get";else if("update"===item)obj.updateUrl=val.url,obj.updateMethod=val.method?val.method:"post";else if("create"===item)obj.createUrl=val.url,obj.createMethod=val.method?val.method:"put";else if("destory"===item)obj.deleteUrl=val.url,obj.deleteMethod=val.method?val.method:"delete";else if("initialize"===item)obj.initialize=val;else if("defaults"===item)obj.defaults="function"==typeof val?val():val;else if("watch"===item)obj.watch=val;else{var code="_RibsCollection.prototype."+item+" = "+val;eval(code)}}),obj},_RibsCollection.prototype._doChangeEvent=function(){},_RibsCollection.prototype.get=function(a){return this.defaults[a]},_RibsCollection.prototype.set=function(a){var b=this;return $.each(a,function(c){b.defaults[c]=a[c],b.watch&&b.changeEvent(c)}),this.defaults},_RibsCollection.prototype.changeEvent=function(a){this.watch[a]&&(_RibsCollection.prototype._doChangeEvent=this.json[this.watch[a]],_RibsCollection.prototype._doChangeEvent.call(this))},_RibsCollection.prototype.fetch=function(a){var b={},c=!0,d=function(){},e=function(){},f=function(){};0!==arguments.length&&(b=a.data?a.data:{},c=a.async?a.async:!0,d=a.done?a.done:function(){},e=a.fail?a.fail:function(){},f=a.always?a.always:function(){});var g=this;$.ajax({url:this.fetchUrl,type:this.fetchMethod,data:b,context:this,async:c,statusCode:{200:d},success:function(a){$.each(a,function(a,b){var c=Ribs.make(g.model,b);g.models.push(c)})},error:e,complete:f})},_RibsCollection.prototype.update=function(a){this.ajax(this.updateUrl,this.updateMethod,a)},_RibsCollection.prototype.destory=function(a){this.ajax(this.deleteUrl,this.deleteMethod,a)},_RibsCollection.prototype.create=function(a){this.ajax(this.createUrl,this.createMethod,a)},_RibsCollection.prototype.ajax=function(a,b,c){var d=c.data?c.data:{},e=c.async?c.async:!0,f=c.done?c.done:function(){},g=c.fail?c.fail:function(){},h=c.always?c.always:function(){};$.ajax({url:a,type:b,context:this,data:d,async:e}).done(f).fail(g).always(h)},_RibsCollection.prototype.size=function(){return this.models.length},_Router.prototype.route=function(a){return this.route=routie(a),this},_Router.prototype.navigate=function(a){routie(a)};var Ribs=new Ribs;window.Ribs={},window.Ribs.make=Ribs.make,window.Ribs.extend=Ribs.extend,window.Ribs.Model=Ribs.Model,window.Ribs.Collection=Ribs.Collection,window.Ribs.View=Ribs.View,window.Ribs.Router=Ribs.Router}();
